<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drone Calc PWA</title>
    <link rel="manifest" href="manifest.json">
    <style>
        body { font-family: -apple-system, sans-serif; padding: 20px; background-color: #f4f4f9; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { color: #333; font-size: 1.2rem; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.9rem; color: #666; margin-bottom: 5px; }
        input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1rem; }
        .result-section { margin-top: 20px; border-top: 2px solid #eee; padding-top: 15px; }
        .res-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.95rem; }
        .res-val { font-weight: bold; color: #007bff; }
        .highlight { background: #fff9c4; padding: 10px; border-radius: 6px; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <h2>Drone Photo Dimensions</h2>
    
    <!-- Step 1-4: Inputs -->
    <div class="input-group">
        <label>1. Sensor Width (Sw) mm</label>
        <input type="number" id="sw" value="17.3" oninput="calculate()">
    </div>
    <div class="input-group">
        <label>2. Sensor Height (Sh) mm</label>
        <input type="number" id="sh" value="13" oninput="calculate()">
    </div>
    <div class="input-group">
        <label>3. Focal Length (f) mm</label>
        <input type="number" id="f" value="12.3" oninput="calculate()">
    </div>
    <div class="input-group">
        <label>4. Altitude (H) m</label>
        <input type="number" id="h" value="120" oninput="calculate()">
    </div>

    <div class="result-section">
        <!-- Step 6-7 -->
        <div class="res-row"><span>FOV Width:</span> <span class="res-val" id="fovw">0</span></div>
        <div class="res-row"><span>FOV Height:</span> <span class="res-val" id="fovh">0</span></div>
        
        <!-- Step 8-11 -->
        <div class="res-row"><span>Ground Width (Gw):</span> <span class="res-val" id="gwm">0 m</span></div>
        <div class="res-row"><span>Ground Height (Gh):</span> <span class="res-val" id="ghm">0 m</span></div>

        <!-- Step 12 -->
        <div class="highlight">
            <div class="res-row"><span><strong>TOTAL AREA:</strong></span> <span class="res-val" id="area">0 m²</span></div>
        </div>
    </div>
</div>

<script>
    function calculate() {
        // Inputs
        const sw = parseFloat(document.getElementById('sw').value) || 0;
        const sh = parseFloat(document.getElementById('sh').value) || 0;
        const f = parseFloat(document.getElementById('f').value) || 0;
        const h = parseFloat(document.getElementById('h').value) || 0;
        
        const hmm = h * 1000; // Step 5 (Hmm)

        if (f > 0) {
            // Step 6 & 7: FOV (Results in Radians)
            const fovW = 2 * Math.atan(sw / (2 * f));
            const fovH = 2 * Math.atan(sh / (2 * f));

            // Step 8 & 9: Ground Width
            const gw = 2 * hmm * Math.tan(fovW / 2);
            const gwm = gw / 1000;

            // Step 10 & 11: Ground Height
            const gh = 2 * hmm * Math.tan(fovH / 2);
            const ghm = gh / 1000;

            // Step 12: Area
            const area = gwm * ghm;

            // Display
            document.getElementById('fovw').innerText = (fovW * (180/Math.PI)).toFixed(2) + "°";
            document.getElementById('fovh').innerText = (fovH * (180/Math.PI)).toFixed(2) + "°";
            document.getElementById('gwm').innerText = gwm.toFixed(2) + " m";
            document.getElementById('ghm').innerText = ghm.toFixed(2) + " m";
            document.getElementById('area').innerText = area.toFixed(2) + " m²";
        }
    }

    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js');
    }
    
    // Initial calc
    calculate();
</script>
</body>
</html>